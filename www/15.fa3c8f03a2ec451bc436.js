(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{g1t5:function(e,t,o){"use strict";o.r(t),o.d(t,"PlaceDetailPageModule",function(){return D});var i=o("ofXK"),n=o("3Pt+"),a=o("TEn/"),s=o("tyNb"),c=o("IzEk"),l=o("eIep"),r=o("9Uo9"),b=o("fXoL");const d=["f"];let m=(()=>{class e{constructor(e){this.modalCtrl=e}ngOnInit(){const e=new Date(this.selectedPlace.availableFrom),t=new Date(this.selectedPlace.availableTo);"random"===this.selectedMode&&(this.startDate=new Date(e.getTime()+Math.random()*(t.getTime()-6048e5-e.getTime())).toISOString(),this.endDate=new Date(new Date(this.startDate).getTime()+Math.random()*(new Date(this.startDate).getTime()+5184e5-new Date(this.startDate).getTime())).toISOString())}onCancel(){this.modalCtrl.dismiss(null,"cancel")}onBookPlace(){this.form.valid&&this.datesValid&&this.modalCtrl.dismiss({bookingData:{firstName:this.form.value["first-name"],lastName:this.form.value["last-name"],guestNumber:+this.form.value["guest-number"],startDate:new Date(this.form.value["date-from"]),endDate:new Date(this.form.value["date-to"])}},"confirm")}datesValid(){const e=new Date(this.form.value["date-from"]);return new Date(this.form.value["date-to"])>e}}return e.\u0275fac=function(t){return new(t||e)(b.Jb(a.Y))},e.\u0275cmp=b.Db({type:e,selectors:[["app-create-booking"]],viewQuery:function(e,t){if(1&e&&b.mc(d,3),2&e){let e;b.dc(e=b.Vb())&&(t.form=e.first)}},inputs:{selectedPlace:"selectedPlace",selectedMode:"selectedMode"},decls:51,vars:9,consts:[["slot","primary"],[3,"click"],["name","close"],[1,"ion-text-center","ion-padding"],[3,"ngSubmit"],["f","ngForm"],["size-sm","6","offset-sm","3"],["position","floating"],["type","text","ngModel","","name","first-name","required",""],["type","text","ngModel","","name","last-name","required",""],["name","guest-number",3,"ngModel"],["value","1"],["value","2"],["value","3"],["size-sm","3","offset-sm","3"],["display-format","MMM DD YYYY","picker-format","YY MMM DD","name","date-from","required","",3,"min","max","ngModel"],["startDateCtrl","ngModel"],["size-sm","3"],["display-format","MMM DD YYYY","picker-format","YY MMM DD","name","date-to","required","",3,"min","max","ngModel"],["type","submit","color","primary","expand","block",3,"disabled"]],template:function(e,t){if(1&e&&(b.Mb(0,"ion-header"),b.Mb(1,"ion-toolbar"),b.Mb(2,"ion-title"),b.jc(3),b.Lb(),b.Mb(4,"ion-buttons",0),b.Mb(5,"ion-button",1),b.Ub("click",function(){return t.onCancel()}),b.Kb(6,"ion-icon",2),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Mb(7,"ion-content",3),b.Mb(8,"form",4,5),b.Ub("ngSubmit",function(){return t.onBookPlace()}),b.Mb(10,"ion-grid"),b.Mb(11,"ion-row"),b.Mb(12,"ion-col",6),b.Mb(13,"ion-item"),b.Mb(14,"ion-label",7),b.jc(15,"First Name"),b.Lb(),b.Kb(16,"ion-input",8),b.Lb(),b.Lb(),b.Lb(),b.Mb(17,"ion-row"),b.Mb(18,"ion-col",6),b.Mb(19,"ion-item"),b.Mb(20,"ion-label",7),b.jc(21,"Last Name"),b.Lb(),b.Kb(22,"ion-input",9),b.Lb(),b.Lb(),b.Lb(),b.Mb(23,"ion-row"),b.Mb(24,"ion-col",6),b.Mb(25,"ion-item"),b.Mb(26,"ion-label",7),b.jc(27,"Number of Guests"),b.Lb(),b.Mb(28,"ion-select",10),b.Mb(29,"ion-select-option",11),b.jc(30,"1"),b.Lb(),b.Mb(31,"ion-select-option",12),b.jc(32,"2"),b.Lb(),b.Mb(33,"ion-select-option",13),b.jc(34,"3"),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Mb(35,"ion-row"),b.Mb(36,"ion-col",14),b.Mb(37,"ion-item"),b.Mb(38,"ion-label",7),b.jc(39,"From"),b.Lb(),b.Kb(40,"ion-datetime",15,16),b.Lb(),b.Lb(),b.Mb(42,"ion-col",17),b.Mb(43,"ion-item"),b.Mb(44,"ion-label",7),b.jc(45,"To"),b.Lb(),b.Kb(46,"ion-datetime",18),b.Lb(),b.Lb(),b.Lb(),b.Mb(47,"ion-row"),b.Mb(48,"ion-col",6),b.Mb(49,"ion-button",19),b.jc(50," Book! "),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Lb()),2&e){const e=b.ec(9),o=b.ec(41);b.zb(3),b.kc(t.selectedPlace.title),b.zb(25),b.bc("ngModel","2"),b.zb(12),b.bc("min",t.selectedPlace.availableFrom.toISOString())("max",t.selectedPlace.availableTo.toISOString())("ngModel",t.startDate),b.zb(6),b.bc("min",o.value)("max",t.selectedPlace.availableTo.toISOString())("ngModel",t.endDate),b.zb(3),b.bc("disabled",!e.valid||!t.datesValid())}},directives:[a.r,a.S,a.R,a.h,a.g,a.s,a.o,n.q,n.k,n.l,a.q,a.F,a.n,a.v,a.z,a.u,a.eb,n.j,n.m,n.o,a.I,a.db,a.J,a.p],styles:[""]}),e})();var u=o("Qe3P"),p=o("Bdq+"),h=o("qXBG");function M(e,t){1&e&&(b.Mb(0,"div",4),b.Kb(1,"ion-spinner",5),b.Lb())}function g(e,t){if(1&e){const e=b.Nb();b.Mb(0,"ion-row"),b.Mb(1,"ion-col",13),b.Mb(2,"ion-button",14),b.Ub("click",function(){return b.fc(e),b.Wb(2).onBookPlace()}),b.jc(3,"Book"),b.Lb(),b.Lb(),b.Lb()}}function f(e,t){if(1&e){const e=b.Nb();b.Mb(0,"ion-grid",6),b.Mb(1,"ion-row"),b.Mb(2,"ion-col",7),b.Kb(3,"ion-img",8),b.Lb(),b.Lb(),b.Mb(4,"ion-row"),b.Mb(5,"ion-col",9),b.Mb(6,"p"),b.jc(7),b.Lb(),b.Lb(),b.Lb(),b.Mb(8,"ion-row"),b.Mb(9,"ion-col",10),b.Mb(10,"p"),b.jc(11),b.Lb(),b.Lb(),b.Lb(),b.Mb(12,"ion-row"),b.Mb(13,"ion-col",7),b.Mb(14,"ion-img",11),b.Ub("click",function(){return b.fc(e),b.Wb().onShowFullMap()}),b.Lb(),b.Lb(),b.Lb(),b.ic(15,g,4,0,"ion-row",12),b.Lb()}if(2&e){const e=b.Wb();b.zb(3),b.bc("src",e.place.imageUrl),b.zb(4),b.kc(e.place.description),b.zb(4),b.kc(e.place.location.address),b.zb(3),b.bc("src",e.place.location.staticMapImageUrl),b.zb(1),b.bc("ngIf",e.isBookable)}}const L=[{path:"",component:(()=>{class e{constructor(e,t,o,i,n,a,s,c,l,r){this.route=e,this.router=t,this.placesService=o,this.navCtrl=i,this.modalCtrl=n,this.actionSheetCtrl=a,this.bookingsService=s,this.loadingCtrl=c,this.authService=l,this.alertCtrl=r,this.isBookable=!1,this.isLoading=!1}ngOnInit(){this.route.paramMap.subscribe(e=>{if(!e.has("placeId"))return void this.navCtrl.navigateBack("/places/tabs/discover");let t;this.isLoading=!0,this.authService.userId.pipe(Object(c.a)(1),Object(l.a)(o=>{if(!o)throw new Error("Found no user!");return t=o,this.placesService.getPlace(e.get("placeId"))})).subscribe(e=>{this.place=e,this.isBookable=e.userId!==t,this.isLoading=!1},e=>{this.alertCtrl.create({header:"An error occured!",message:"Could not load place",buttons:[{text:"Okay",handler:()=>{this.router.navigateByUrl("/places/tabs/discover")}}]}).then(e=>{e.present()})})})}onBookPlace(){this.actionSheetCtrl.create({header:"Choose an Action",buttons:[{text:"Select Date",handler:()=>{this.openBookingModel("select")}},{text:"Random Date",handler:()=>{this.openBookingModel("random")}},{text:"Cancel",role:"cancel"}]}).then(e=>{e.present()})}openBookingModel(e){console.log(e),this.modalCtrl.create({component:m,componentProps:{selectedPlace:this.place,selectedMode:e}}).then(e=>(e.present(),e.onDidDismiss())).then(e=>{const t=e.data.bookingData;"confirm"===e.role&&this.loadingCtrl.create({message:"Booking place..."}).then(e=>{e.present(),this.bookingsService.addBooking(this.place.id,this.place.title,this.place.imageUrl,t.firstName,t.lastName,t.guestNumber,t.startDate,t.endDate).subscribe(()=>{e.dismiss()})})})}onShowFullMap(){this.modalCtrl.create({component:r.a,componentProps:{center:{lat:this.place.location.lat,lng:this.place.location.lng},selectable:!1,closeButtonText:"Close",title:this.place.location.address}}).then(e=>{e.present()})}ngOnDestroy(){this.placeSub&&this.placeSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(b.Jb(s.a),b.Jb(s.g),b.Jb(u.a),b.Jb(a.Z),b.Jb(a.Y),b.Jb(a.a),b.Jb(p.a),b.Jb(a.W),b.Jb(h.a),b.Jb(a.b))},e.\u0275cmp=b.Db({type:e,selectors:[["app-place-detail"]],decls:9,vars:3,consts:[["slot","start"],["defaultHref","/places/tabs/discover"],["class","ion-text-center",4,"ngIf"],["class","ion-no-padding",4,"ngIf"],[1,"ion-text-center"],["color","primary"],[1,"ion-no-padding"],["size-sm","6","offset-sm","3"],[3,"src"],["size-sm","6","offset-sm","3",1,"ion-text-center","ion-padding"],["size-sm","6","offset-sm","3",1,"ion-padding","ion-text-center"],[1,"location-image",3,"src","click"],[4,"ngIf"],["size-sm","6","offset-sm","3",1,"ion-text-center"],["color","primary ion-margin",3,"click"]],template:function(e,t){1&e&&(b.Mb(0,"ion-header"),b.Mb(1,"ion-toolbar"),b.Mb(2,"ion-buttons",0),b.Kb(3,"ion-back-button",1),b.Lb(),b.Mb(4,"ion-title"),b.jc(5),b.Lb(),b.Lb(),b.Lb(),b.Mb(6,"ion-content"),b.ic(7,M,2,0,"div",2),b.ic(8,f,16,5,"ion-grid",3),b.Lb()),2&e&&(b.zb(5),b.kc(t.isLoading?"Loading...":t.place.title),b.zb(2),b.bc("ngIf",t.isLoading),b.zb(1),b.bc("ngIf",!t.isLoading))},directives:[a.r,a.S,a.h,a.e,a.f,a.R,a.o,i.k,a.K,a.q,a.F,a.n,a.t,a.g],styles:[".location-image[_ngcontent-%COMP%]{width:100%;height:25rem;max-height:30vh;object-fit:cover}p[_ngcontent-%COMP%]{margin:none}"]}),e})()}];let v=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=b.Hb({type:e}),e.\u0275inj=b.Gb({imports:[[s.i.forChild(L)],s.i]}),e})(),D=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=b.Hb({type:e}),e.\u0275inj=b.Gb({imports:[[i.b,n.f,a.U,v]]}),e})()}}]);